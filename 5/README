Still need to comment/clean, but it works, so I'm sending it in.

Assistance with the two-dimensional array thanks to: http://www.lysator.liu.se/c/c-faq/c-2.html

